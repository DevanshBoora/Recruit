{% extends "base.html" %}

{% block title %}Interview Feedback - Job Application System{% endblock %}

{% block content %}
<h1>Interview Feedback</h1>

<div class="card">
    <h3>Submit Interview Feedback</h3>
    {% if candidates %}
        <form method="POST">
            <div class="form-group">
                <label for="candidate_id">Select Candidate:</label>
                <select id="candidate_id" name="candidate_id" required>
                    <option value="">Choose a candidate...</option>
                    {% for candidate in candidates %}
                        <option value="{{ candidate.id }}">
                            {{ candidate.applicant_name }} ({{ candidate.applicant_email }}) - 
                            Interview: {{ candidate.interview_date.strftime('%Y-%m-%d %H:%M') if candidate.interview_date else 'Not scheduled' }}
                        </option>
                    {% endfor %}
                </select>
            </div>
            
            <div class="form-group">
                <label for="communication_score">Communication Score (1-10):</label>
                <input type="number" id="communication_score" name="communication_score" min="1" max="10" step="0.1" required>
            </div>
            
            <div class="form-group">
                <label for="technical_score">Technical Score (1-10):</label>
                <input type="number" id="technical_score" name="technical_score" min="1" max="10" step="0.1" required>
            </div>
            
            <div class="form-group">
                <label for="problem_solving_score">Problem Solving Score (1-10):</label>
                <input type="number" id="problem_solving_score" name="problem_solving_score" min="1" max="10" step="0.1" required>
            </div>
            
            <div class="form-group">
                <label for="decision">Decision:</label>
                <select id="decision" name="decision" required>
                    <option value="">Select decision...</option>
                    <option value="Accepted">Accept</option>
                    <option value="Rejected">Reject</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="comments">Comments:</label>
                <textarea id="comments" name="comments" placeholder="Enter detailed feedback about the candidate's performance..." required></textarea>
            </div>
            
            <button type="submit" class="btn btn-success">Submit Feedback</button>
        </form>
    {% else %}
        <div class="alert info">
            <p>No candidates available for feedback. Candidates must have scheduled interviews before feedback can be submitted.</p>
        </div>
    {% endif %}
</div>

<div class="card">
    <h3>Candidates Awaiting Feedback</h3>
    {% if candidates %}
        <table>
            <thead>
                <tr>
                    <th>Candidate ID</th>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Interview Date</th>
                </tr>
            </thead>
            <tbody>
                {% for candidate in candidates %}
                <tr>
                    <td>{{ candidate.id }}</td>
                    <td>{{ candidate.applicant_name }}</td>
                    <td>{{ candidate.applicant_email }}</td>
                    <td>{{ candidate.interview_date.strftime('%Y-%m-%d %H:%M') if candidate.interview_date else 'Not scheduled' }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>No candidates awaiting feedback.</p>
    {% endif %}
</div>

<script>
// Add some validation for the scores
document.addEventListener('DOMContentLoaded', function() {
    const scoreInputs = document.querySelectorAll('input[type="number"]');
    
    scoreInputs.forEach(input => {
        input.addEventListener('input', function() {
            const value = parseFloat(this.value);
            if (value < 1) {
                this.value = 1;
            } else if (value > 10) {
                this.value = 10;
            }
        });
    });
});
</script>
{% endblock %}